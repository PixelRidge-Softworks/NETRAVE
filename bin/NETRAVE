#!/usr/bin/env ruby

require 'yaml'
require_relative '../lib/utils/system_information_gather.rb'
require_relative '../lib/utils/database_manager.rb'
require_relative '../lib/utils/first_run_init.rb'

# Check if config.yml exists, if not, create it
unless File.exist?('config.yml')
  first_run_init = FirstRunInit.new
  db_details = first_run_init.ask_for_db_details
  first_run_init.write_db_details_to_config_file(db_details)
end

# Load database configuration
db_details = YAML.load_file('config.yml')

# Initialize DatabaseManager and test connection
db_manager = DatabaseManager.new
if db_manager.test_db_connection(db_details)
  puts "Successfully connected to the database."
else
  puts "Failed to connect to the database. Please check your configuration."
  exit 1
end

# Initialize the first run setup
first_run_setup = FirstRunInit.new(db_manager)
first_run_setup.run

# TODO: Add the rest of your application logic here
